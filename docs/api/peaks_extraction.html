
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Peaks Extraction &#8212; Biotuner 0.0.16 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/example_gallery_styles.css?v=df915669" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=baac2cea"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/peaks_extraction';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Peaks Extension" href="peaks_extension.html" />
    <link rel="prev" title="Harmonicity Metrics" href="metrics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.0.16" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Biotuner 0.0.16 documentation - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Biotuner 0.0.16 documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Menu:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started with Biotuner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite_us.html">Cite us</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/biotuner_MNE/biotuner_MNE.html">Harmonicity Metrics Computation on MNE Epochs File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/peaks_extraction/peaks_extraction.html">Peaks extraction methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/harmonicity_metrics/harmonicity_metrics.html">Harmonicity metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/harmonic_spectrum/harmonic_spectrum.html">From Spectral Peaks to Harmonic Spectrum Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/toolbox_paper_notebook/toolbox_paper_notebook.html">Biotuner Paper Design and Implementation Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/toolbox_paper_result_notebook/toolbox_paper_result_notebook.html">Biotuner Toolbox Paper Results Figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/scale_construction/scale_construction.html">Constructing musical tunings with biosignals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/spectral_chords/spectral_chords.html">Deriving spectral chords from biosignals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/rhythm_construction/rhythm_construction.html">Constructing euclidian rhythms from biotunings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/phase_amplitude_coupling/phase_amplitude_coupling.html">Phase-Amplitude Coupling</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">API</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="biotuner_object.html">Biotuner object</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="metrics.html">Harmonicity Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">Peaks Extraction</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="peaks_extension.html">Peaks Extension</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="harmonic_spectrum.html">Harmonic spectrum</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="harmonic_connectivity.html">Harmonic connectivity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="transitional_harmony.html">Transitional Harmony</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="scale_construction.html">Scale construction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="rhythm_construction.html">Rhythm construction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="utils.html">Biotuner utilities</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/api/peaks_extraction.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Peaks Extraction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.EMD_eeg"><code class="docutils literal notranslate"><span class="pre">EMD_eeg()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SSA_EEG"><code class="docutils literal notranslate"><span class="pre">SSA_EEG()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.extract_welch_peaks"><code class="docutils literal notranslate"><span class="pre">extract_welch_peaks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.compute_FOOOF"><code class="docutils literal notranslate"><span class="pre">compute_FOOOF()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.HilbertHuang1D"><code class="docutils literal notranslate"><span class="pre">HilbertHuang1D()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.cepstrum"><code class="docutils literal notranslate"><span class="pre">cepstrum()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.cepstral_peaks"><code class="docutils literal notranslate"><span class="pre">cepstral_peaks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.pac_frequencies"><code class="docutils literal notranslate"><span class="pre">pac_frequencies()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.polycoherence"><code class="docutils literal notranslate"><span class="pre">polycoherence()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.polyspectrum_frequencies"><code class="docutils literal notranslate"><span class="pre">polyspectrum_frequencies()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.harmonic_recurrence"><code class="docutils literal notranslate"><span class="pre">harmonic_recurrence()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.endogenous_intermodulations"><code class="docutils literal notranslate"><span class="pre">endogenous_intermodulations()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.compute_sidebands"><code class="docutils literal notranslate"><span class="pre">compute_sidebands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.UnivariateTransformerMixin"><code class="docutils literal notranslate"><span class="pre">UnivariateTransformerMixin</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.UnivariateTransformerMixin.fit_transform"><code class="docutils literal notranslate"><span class="pre">UnivariateTransformerMixin.fit_transform()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.fit"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.transform"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis.transform()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="peaks-extraction">
<h1>Peaks Extraction<a class="headerlink" href="#peaks-extraction" title="Link to this heading">#</a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="py function" id="module-biotuner.peaks_extraction">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.EMD_eeg">
<span class="sig-name descname"><span class="pre">EMD_eeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EMD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrema_detection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simple'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nIMFs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#EMD_eeg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.EMD_eeg" title="Link to this definition">#</a></dt>
<dd><p>The Empirical Mode Decomposition is a data-adaptive multiresolution
technique to decompose a signal into physically meaningful components,
the Intrinsic Mode Functions (IMFs). It works like a dyadic filter bank.
Hence, a log2 structure characterizes the relation between successive IMFs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>method</strong> (<em>str, default=’EMD’</em>) – Type of Empirical Mode Decomposition. The available types are:</p>
<ul>
<li><p>‘EMD’</p></li>
<li><p>‘EEMD’</p></li>
<li><p>‘CEEMDAN’</p></li>
</ul>
</li>
<li><p><strong>graph</strong> (<em>bool, default=False</em>) – Defines if graph is created.</p></li>
<li><p><strong>extrema_detection</strong> (<em>str, default=’simple’</em>) –</p>
<ul>
<li><p>‘simple’</p></li>
<li><p>‘parabol’</p></li>
</ul>
</li>
<li><p><strong>nIMFs</strong> (<em>int, default=5</em>) – Number of IMFs to plot when ‘graph’ = True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>eIMFs</strong> (<em>array (nIMFS, numDataPoints)</em>) – Returns an array of n Intrinsic Mode Functions
by the initial number of data points.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IMFs</span> <span class="o">=</span> <span class="n">EMD_eeg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;EMD&quot;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extrema_detection</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">nIMFs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DATA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;IMFs&#39;</span><span class="p">,</span> <span class="n">IMFs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">DATA (9501,) IMFs (11, 9501)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>1. Huang, Norden E., et al. “The empirical mode decomposition and the
Hilbert spectrum for nonlinear and non-stationary time series analysis.”
Proceedings of the Royal Society of London. Series A: Mathematical,
Physical and Engineering Sciences 454.1971 (1998): 903-995.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.SSA_EEG">
<span class="sig-name descname"><span class="pre">SSA_EEG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#SSA_EEG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.SSA_EEG" title="Link to this definition">#</a></dt>
<dd><p>Applies Singular Spectrum Analysis (SSA) to the input signal
to extract its main frequency components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – The input signal as a 1D numpy array.</p></li>
<li><p><strong>n_components</strong> (<em>int, default=3</em>) – The number of components to extract from the signal.</p></li>
<li><p><strong>graph</strong> (<em>bool, default=False</em>) – Whether to plot the original signal and the extracted components.</p></li>
<li><p><strong>window_size</strong> (<em>int, default=20</em>) – The size of the sliding window used in SSA.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>numpy.ndarray</em> – The extracted components as a 2D numpy array,
where each row corresponds to a component.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">components</span> <span class="o">=</span> <span class="n">SSA_EEG</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">2000</span><span class="p">],</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">components</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(5, 1000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.extract_welch_peaks">
<span class="sig-name descname"><span class="pre">extract_welch_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FREQ_BANDS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noverlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_peaks_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended_returns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#extract_welch_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.extract_welch_peaks" title="Link to this definition">#</a></dt>
<dd><p>Extract frequency peaks using Welch’s method
for periodograms computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>sf</strong> (<em>int</em>) – Sampling frequency.</p></li>
<li><p><strong>precision</strong> (<em>float, default=0.5</em>) – Size of a frequency bin in Hertz.</p></li>
<li><p><strong>min_freq</strong> (<em>float, default=1.0</em>) – Minimum frequency to consider when out_type=’all’.</p></li>
<li><p><strong>max_freq</strong> (<em>float</em>) – Maximum frequency to consider when out_type=’all’.</p></li>
<li><p><strong>FREQ_BANDS</strong> (<em>List of lists</em>) – Each sublist contains the
minimum and maximum values for each frequency band.</p></li>
<li><p><strong>average</strong> (<em>str, default=’median’</em>) – Method for averaging periodograms.</p>
<ul>
<li><p>‘mean’</p></li>
<li><p>‘median’</p></li>
</ul>
</li>
<li><p><strong>nperseg</strong> (<em>int, default=None</em>) – Length of each segment.
If None, nperseg = nfft/smooth</p></li>
<li><p><strong>nfft</strong> (<em>int, default=None</em>) – Length of the FFT used, if a zero padded FFT is desired.
If None, nfft = sf/(1/precision)</p></li>
<li><p><strong>noverlap</strong> (<em>int, default=None</em>) – Number of points to overlap between segments.
If None, noverlap = nperseg // 2.</p></li>
<li><p><strong>find_peaks_method</strong> (<em>str, default=’maxima’</em>) –</p>
<ul>
<li><p>‘maxima’</p></li>
<li><p>‘wavelet’</p></li>
</ul>
</li>
<li><p><strong>width</strong> (<em>int, default=2</em>) – Required width of peaks in samples.</p></li>
<li><p><strong>rel_height</strong> (<em>float, default=0.7</em>) – Chooses the relative height at which the peak width is measured as a
percentage of its prominence. 1.0 calculates the width of the peak at
its lowest contour line while 0.5 evaluates at half the
prominence height.</p></li>
<li><p><strong>prominence</strong> (<em>float, default=1</em>) – Required prominence of peaks.</p></li>
<li><p><strong>out_type</strong> (<em>str, default=’all’</em>) – Defines how many peaks are outputed. The options are:</p>
<ul>
<li><p>‘single’</p></li>
<li><p>‘bands’</p></li>
<li><p>‘all’</p></li>
</ul>
</li>
<li><p><strong>extended_returns</strong> (<em>bool, default=True</em>) – Defines if psd and frequency bins values are output along
the peaks and amplitudes.</p></li>
<li><p><strong>smooth</strong> (<em>int, default=1</em>) – Number used to divide nfft to derive nperseg.
Higher values will provide smoother periodograms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>peak</strong> (<em>List(float)</em>) – Frequency value.</p></li>
<li><p><strong>amp</strong> (<em>List(float)</em>) – Amplitude value.</p></li>
<li><p><strong>freqs</strong> (<em>Array</em>) – Frequency bins</p></li>
<li><p><strong>psd</strong> (<em>Array</em>) – Power spectrum density of each frequency bin</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FREQ_BANDS</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span> <span class="o">=</span> <span class="n">extract_welch_peaks</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="mi">1200</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">FREQ_BANDS</span><span class="o">=</span><span class="n">FREQ_BANDS</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">precision</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">out_type</span><span class="o">=</span><span class="s2">&quot;bands&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="n">extended_returns</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                  <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span>
<span class="go">[1.5, 5.5, 9.0, 15.0, 22.5, 32.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.compute_FOOOF">
<span class="sig-name descname"><span class="pre">compute_FOOOF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noverlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended_returns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#compute_FOOOF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.compute_FOOOF" title="Link to this definition">#</a></dt>
<dd><p>FOOOF model the power spectrum as a combination of
two distinct functional processes:
- An aperiodic component, reflecting 1/f like characteristics
- A variable number of periodic components (putative oscillations),</p>
<blockquote>
<div><p>as peaks rising above the aperiodic component.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>sf</strong> (<em>int</em>) – Sampling frequency.</p></li>
<li><p><strong>precision</strong> (<em>float, default=0.5</em>) – Size of a frequency bin in Hertz before sending to FOOOF.</p></li>
<li><p><strong>max_freq</strong> (<em>float, default=80</em>) – Maximum frequency to consider as a peak.</p></li>
<li><p><strong>noverlap</strong> (<em>int, default=None</em>) – Number of points to overlap between segments.
If None, noverlap = nperseg // 2.</p></li>
<li><p><strong>nperseg</strong> (<em>int</em>) – Length of each segment.</p></li>
<li><p><strong>nfft</strong> (<em>int, default=None</em>) – Length of the FFT used, if a zero padded FFT is desired.
If None, the FFT length is nperseg.</p></li>
<li><p><strong>n_peaks</strong> (<em>int, default=5</em>) – Maximum number of peaks. If FOOOF finds higher number of peaks,
the peaks with highest amplitude will be retained.</p></li>
<li><p><strong>extended_returns</strong> (<em>bool, default=False</em>) – Defines if psd and frequency bins values are output along
the peaks and amplitudes.</p></li>
<li><p><strong>graph</strong> (<em>bool, default=False</em>) – Defines if a graph is generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>peaks</strong> (<em>List(float)</em>) – Frequency values.</p></li>
<li><p><strong>amps</strong> (<em>List(float)</em>) – Amplitude values.</p></li>
<li><p><strong>freqs</strong> (<em>Array</em>) – Frequency bins</p></li>
<li><p><strong>psd</strong> (<em>Array</em>) – Power spectrum density of each frequency bin</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span> <span class="o">=</span> <span class="n">compute_FOOOF</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_peaks</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span>
<span class="go">[7.24, 14.71, 5.19]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>Donoghue T, Haller M, Peterson EJ, Varma P, Sebastian P, Gao R, Noto T, Lara AH, Wallis JD,
Knight RT, Shestyuk A, Voytek B (2020). Parameterizing neural power spectra into periodic
and aperiodic components. Nature Neuroscience, 23, 1655-1665. DOI: 10.1038/s41593-020-00744-x</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.HilbertHuang1D">
<span class="sig-name descname"><span class="pre">HilbertHuang1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nIMFs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_spread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_first_IMF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#HilbertHuang1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.HilbertHuang1D" title="Link to this definition">#</a></dt>
<dd><p>The Hilbert-Huang transform provides a description of how the energy
or power within a signal is distributed across frequency.
The distributions are based on the instantaneous frequency and
amplitude of a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>sf</strong> (<em>int</em>) – Sampling frequency.</p></li>
<li><p><strong>graph</strong> (<em>bool, default=False</em>) – Defines if a graph is generated.</p></li>
<li><p><strong>nIMFs</strong> (<em>int, default=5</em>) – Number of intrinsic mode functions (IMFs) to keep when
Empirical Mode Decomposition (EMD) is computed.</p></li>
<li><p><strong>min_freq</strong> (<em>float, default=1</em>) – Minimum frequency to consider.</p></li>
<li><p><strong>max_freq</strong> (<em>float, default=80</em>) – Maximum frequency to consider.</p></li>
<li><p><strong>precision</strong> (<em>float, default=0.1</em>) – Value in Hertz corresponding to the minimal step between two
frequency bins.</p></li>
<li><p><strong>bin_spread</strong> (<em>str, default=’log’</em>) –</p>
<ul>
<li><p>‘linear’</p></li>
<li><p>‘log’</p></li>
</ul>
</li>
<li><p><strong>smooth_sigma</strong> (<em>float, default=None</em>) – Sigma value for gaussian smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>IF</strong> (<em>array (numDataPoints,nIMFs)</em>) – instantaneous frequencies associated with each IMF.</p></li>
<li><p><strong>peaks</strong> (<em>List(float)</em>) – Frequency values.</p></li>
<li><p><strong>amps</strong> (<em>List(float)</em>) – Amplitude values.</p></li>
<li><p><strong>spec</strong> (<em>array (nIMFs, nbins)</em>) – Power associated with all bins for each IMF</p></li>
<li><p><strong>bins</strong> (<em>array (nIMFs, nbins)</em>) – Frequency bins for each IMF</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">HilbertHuang1D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">nIMFs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span>
<span class="go">[2.24, 8.08, 11.97, 19.61, 64.06]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.cepstrum">
<span class="sig-name descname"><span class="pre">cepstrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_cepstrum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#cepstrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.cepstrum" title="Link to this definition">#</a></dt>
<dd><p>The cepstrum is the result of computing the
inverse Fourier transform (IFT) of the logarithm of
the estimated signal spectrum. The method is a tool for
investigating periodic structures in frequency spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>sf</strong> (<em>int</em>) – Sampling frequency.</p></li>
<li><p><strong>plot_cepstrum</strong> (<em>bool, default=False</em>) – Determines wether a plot is generated.</p></li>
<li><p><strong>min_freq</strong> (<em>float, default=1.5</em>) – Minimum frequency to consider.</p></li>
<li><p><strong>max_freq</strong> (<em>float, default=80</em>) – Maximum frequency to consider.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cepstrum</strong> (<em>array (nbins,)</em>) – Power of the cepstrum for each quefrency.</p></li>
<li><p><strong>quefrency_vector</strong> (<em>array(nbins,)</em>) – Values of each quefrency bins.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.cepstral_peaks">
<span class="sig-name descname"><span class="pre">cepstral_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cepstrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quefrency_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#cepstral_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.cepstral_peaks" title="Link to this definition">#</a></dt>
<dd><p>This function extract cepstral peaks based on
the :func:’biotuner.peaks_extraction.cepstrum’ function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cepstrum</strong> (<em>array</em>) – Values of cepstrum power across all quefrency bins.</p></li>
<li><p><strong>quefrency_vector</strong> (<em>array</em>) – Values of all the quefrency bins.</p></li>
<li><p><strong>max_time</strong> (<em>float</em>) – Maximum value of the quefrency to keep in seconds.</p></li>
<li><p><strong>min_time</strong> (<em>float</em>) – Minimum value of the quefrency to keep in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>peaks</strong> (<em>List(float)</em>) – Quefrency values.</p></li>
<li><p><strong>amps</strong> (<em>List(float)</em>) – Amplitude values.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cepst</span><span class="p">,</span> <span class="n">quef</span> <span class="o">=</span> <span class="n">cepstrum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">plot_cepstrum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span> <span class="o">=</span> <span class="n">cepstral_peaks</span><span class="p">(</span><span class="n">cepst</span><span class="p">,</span> <span class="n">quef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PEAKS&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AMPS&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">amps</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">PEAKS [24.0, 16.0, 11.0]</span>
<span class="go">AMPS [244.0, 151.0, 101.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.pac_frequencies">
<span class="sig-name descname"><span class="pre">pac_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'duprelatour'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drive_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_drive_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_drive_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sig_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_sig_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_fq_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_fq_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#pac_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.pac_frequencies" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>A function to compute the comodulogram for phase-amplitude coupling</dt><dd><p>and extract the pairs of peaks with maximum coupling value.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>array (numDataPoints,)</em>) – Single time series.</p></li>
<li><p><strong>sf</strong> (<em>int</em>) – Sampling frequency.</p></li>
<li><p><strong>method</strong> (<em>str</em>) –</p>
<ul>
<li><p>‘ozkurt’</p></li>
<li><p>‘canolty’</p></li>
<li><p>‘tort’</p></li>
<li><p>‘penny’</p></li>
<li><p>‘vanwijk’</p></li>
<li><p>‘duprelatour’</p></li>
<li><p>‘colgin’</p></li>
<li><p>‘sigl’</p></li>
<li><p>‘bispectrum’</p></li>
</ul>
</li>
<li><p><strong>n_values</strong> (<em>int, default=10</em>) – Number of pairs of drive and modulated frequencies to keep.</p></li>
<li><p><strong>drive_precision</strong> (<em>float, default=0.05</em>) – Value (hertz) of one frequency bin of the phase signal.</p></li>
<li><p><strong>max_drive_freq</strong> (<em>float, default=6</em>) – Minimum value (hertz) of the phase signal.</p></li>
<li><p><strong>min_drive_freq</strong> (<em>float, default=3</em>) – Maximum value (hertz) of the phase signal.</p></li>
<li><p><strong>sig_precision</strong> (<em>float, default=1</em>) – Value (hertz) of one frequency bin of the amplitude signal.</p></li>
<li><p><strong>max_sig_freq</strong> (<em>float, default=50</em>) – Maximum value (hertz) of the amplitude signal.</p></li>
<li><p><strong>min_sig_freq</strong> (<em>float, default=8</em>) – Minimum value (hertz) of the amplitude signal.</p></li>
<li><p><strong>low_fq_width</strong> (<em>float, default=0.5</em>) – Bandwidth of the band-pass filter (phase signal).</p></li>
<li><p><strong>high_fq_width</strong> (<em>float, default=1</em>) – Bandwidth of the band-pass filter (amplitude signal).</p></li>
<li><p><strong>plot</strong> (<em>bool, default=False</em>) – Determines if a plot of the comodulogram is created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pac_freqs</strong> (<em>List of lists</em>) – Each sublist correspond to pairs of frequencies for the
phase and amplitude signals with maximal coupling value.</p></li>
<li><p><strong>pac_coupling</strong> (<em>List</em>) – Coupling values associated with each pairs of phase and amplitude
frequencies.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pac_frequencies</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="mi">1200</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;canolty&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">n_values</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">drive_precision</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">max_drive_freq</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">min_drive_freq</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">sig_precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">max_sig_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">min_sig_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">low_fq_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">high_fq_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="p">)</span>
<span class="go">([[3.0, 10.0], [3.0, 11.0], [3.8, 15.0], [4.0, 11.0], [3.2, 11.0]],</span>
<span class="go">[3.544482291850382e-08,</span>
<span class="go">3.44758700485373e-08,</span>
<span class="go">4.125714430185903e-08,</span>
<span class="go">3.780184228154704e-08,</span>
<span class="go">3.3232328382531826e-08])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.polycoherence">
<span class="sig-name descname"><span class="pre">polycoherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#polycoherence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.polycoherence" title="Link to this definition">#</a></dt>
<dd><p>Calculate the polycoherence between frequencies and their sum frequency.</p>
<p>The polycoherence is defined as a function of two frequencies:
<a href="#id3"><span class="problematic" id="id4">|&lt;prod(spec(fi)) * conj(spec(sum(fi)))&gt;|</span></a> ** n0 / &lt;<a href="#id5"><span class="problematic" id="id6">|prod(spec(fi))|</span></a>&gt; ** n1 * &lt;<a href="#id7"><span class="problematic" id="id8">|spec(sum(fi))|</span></a>&gt; ** n2
where i is from 1 to N. For N=2, it is the bicoherence, and for N&gt;2, it is the polycoherence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em>) – 1D data array.</p></li>
<li><p><strong>fs</strong> (<em>float</em>) – Sampling rate.</p></li>
<li><p><strong>ofreqs</strong> (<em>float</em>) – Fixed frequencies.</p></li>
<li><p><strong>dim</strong> (<em>{‘sum’, 1, 2, 0}, optional</em>) – Dimension of the polycoherence calculation:</p>
<ul>
<li><p>‘sum’: 1D polycoherence with fixed frequency sum. The first argument after fs is the frequency sum. Other fixed frequencies possible.</p></li>
<li><p>1: 1D polycoherence as a function of f1, at least one fixed frequency (ofreq) is expected.</p></li>
<li><p>2: 2D polycoherence as a function of f1 and f2. ofreqs are additional fixed frequencies.</p></li>
<li><p>0: Polycoherence for fixed frequencies.</p></li>
</ul>
</li>
<li><p><strong>norm</strong> (<em>{2, 0, tuple}, optional</em>) – Normalization scheme:</p>
<ul>
<li><p>2: Return polycoherence, n0 = n1 = n2 = 2 (default).</p></li>
<li><p>0: Return polyspectrum, &lt;prod(spec(fi)) * conj(spec(sum(fi)))&gt;.</p></li>
<li><p>tuple(n1, n2): General case with n0=2.</p></li>
</ul>
</li>
<li><p><strong>synthetic</strong> (<em>list, optional</em>) – Used for synthetic signal for some frequencies. List of 3-item tuples (freq, amplitude, phase). The freq must coincide with the first fixed frequencies (ofreq, except for dim=’sum’).</p></li>
<li><p><strong>flim1, flim2</strong> (<em>tuple, optional</em>) – Frequency limits for 2D case.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass to <cite>scipy.signal.spectrogram</cite>. Important parameters are nperseg, noverlap, and nfft.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>polycoherence</strong> (<em>ndarray</em>) – The polycoherence or polyspectrum.</p></li>
<li><p><strong>freqs</strong> (<em>ndarray</em>) – Frequency array.</p></li>
<li><p><strong>spectrum</strong> (<em>ndarray</em>) – The power spectrum of the signal.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>&lt; &gt; denotes averaging and | | denotes absolute value.</p>
<p class="rubric">References</p>
<p>FROM: <a class="github reference external" href="https://github.com/trichter/polycoherence">trichter/polycoherence</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.polyspectrum_frequencies">
<span class="sig-name descname"><span class="pre">polyspectrum_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noverlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bicoherence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">50)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">50)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#polyspectrum_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.polyspectrum_frequencies" title="Link to this definition">#</a></dt>
<dd><p>Calculate the frequencies and amplitudes of the top n polyspectral components
using the bispectrum or bicoherence method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – The input signal.</p></li>
<li><p><strong>sf</strong> (<em>float</em>) – The sampling frequency of the input signal.</p></li>
<li><p><strong>precision</strong> (<em>float</em>) – The desired frequency precision of the output.</p></li>
<li><p><strong>n_values</strong> (<em>int, default=10</em>) – The number of top polyspectral components to return. Default is 10.</p></li>
<li><p><strong>nperseg</strong> (<em>int, default=None</em>) – The length of each segment used in the FFT calculation. If not specified,
defaults to sf.</p></li>
<li><p><strong>noverlap</strong> (<em>int, default=None</em>) – The number of samples to overlap between adjacent segments. If not specified,
When default is None, noverlap = sf // 10.</p></li>
<li><p><strong>method</strong> (<em>str, default=’bicoherence’</em>) – The method to use for calculating the polyspectrum. Can be either:</p>
<ul>
<li><p>“bispectrum”</p></li>
<li><p>“bicoherence”</p></li>
</ul>
</li>
<li><p><strong>flim1</strong> (<em>tuple of float, default=(2, 50)</em>) – The frequency limits for the first frequency axis.</p></li>
<li><p><strong>flim2</strong> (<em>tuple of float, default=(2, 50)</em>) – The frequency limits for the second frequency axis.</p></li>
<li><p><strong>graph</strong> (<em>bool, default=False</em>) – Whether to plot the polyspectrum using matplotlib.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple of list of float</em> – A tuple containing the frequencies and amplitudes of the top n polyspectral
components, respectively.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polyspectrum_frequencies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_values</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bicoherence&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="n">flim1</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">flim2</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="p">)</span>
<span class="go">([[23.25, 4.916666666666666],</span>
<span class="go">[23.333333333333332, 4.916666666666666],</span>
<span class="go">[23.166666666666664, 4.916666666666666],</span>
<span class="go">[23.416666666666664, 4.916666666666666],</span>
<span class="go">[27.25, 4.75]],</span>
<span class="go">[[0.8518411], [0.84810454], [0.8344524], [0.83267957], [0.8235908]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.harmonic_recurrence">
<span class="sig-name descname"><span class="pre">harmonic_recurrence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_harms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">harm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#harmonic_recurrence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.harmonic_recurrence" title="Link to this definition">#</a></dt>
<dd><p>Identify spectral peaks that have the highest recurrence in the spectrum based on their harmonic series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>list of floats</em>) – List of all spectral peaks.</p></li>
<li><p><strong>amps</strong> (<em>list of floats</em>) – List of amplitudes of the spectral peaks.</p></li>
<li><p><strong>min_freq</strong> (<em>float, default=1</em>) – Minimum frequency to consider.</p></li>
<li><p><strong>max_freq</strong> (<em>float, default=30</em>) – Maximum frequency to consider.</p></li>
<li><p><strong>min_harms</strong> (<em>int, default=2</em>) – Minimum number of harmonic recurrence to keep a peak.</p></li>
<li><p><strong>harm_limit</strong> (<em>int, default=128</em>) – Highest harmonic to consider.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>tuple of arrays</em> – Returns a tuple of arrays containing:</p>
<ul class="simple">
<li><p><cite>max_n</cite>: Number of harmonic recurrences for each selected peak.</p></li>
<li><p><cite>max_peaks</cite>: Frequencies of each selected peak.</p></li>
<li><p><cite>max_amps</cite>: Amplitudes of each selected peak.</p></li>
<li><p><cite>harmonics</cite>: List of harmonic ratios of each selected peak.</p></li>
<li><p><cite>harmonic_peaks</cite>: Frequencies of peaks that share harmonic ratios with each selected peak.</p></li>
<li><p><cite>harm_peaks_fit</cite>: List containing detailed information about each selected peak.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data_examples/EEG_pareidolia/parei_data_1000ts.npy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">extract_welch_peaks</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">data</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="mi">1000</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">max_freq</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">extended_returns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">out_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">min_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">max_n</span><span class="p">,</span> <span class="n">peaks_temp</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">amps_temp</span><span class="p">,</span><span class="n">harms</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">harm_peaks</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">harm_peaks_fit</span><span class="p">)</span> <span class="o">=</span> <span class="n">harmonic_recurrence</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span><span class="p">,</span> <span class="n">min_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="n">max_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_harms</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                       <span class="n">harm_limit</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks_temp</span>
<span class="go">array([ 2.,  6., 27., 44.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.endogenous_intermodulations">
<span class="sig-name descname"><span class="pre">endogenous_intermodulations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_IMs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#endogenous_intermodulations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.endogenous_intermodulations" title="Link to this definition">#</a></dt>
<dd><p>Computes the intermodulation components (IMCs) for each pair of peaks and compares the IMCs
with peak values. If a pair of peaks has a number of IMCs equal to or greater than the
<cite>min_IMs</cite> parameter, these peaks and the associated IMCs are stored in the <cite>IMCs_all</cite> dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>array_like</em>) – An array of peak frequencies.</p></li>
<li><p><strong>amps</strong> (<em>array_like</em>) – An array of amplitudes corresponding to the peak frequencies.</p></li>
<li><p><strong>order</strong> (<em>int, default=3</em>) – The maximum order of intermodulation to consider.</p></li>
<li><p><strong>min_IMs</strong> (<em>int, default=2</em>) – The minimum number of IMCs required for a pair of peaks to be stored in the <cite>IMCs_all</cite> dictionary.</p></li>
<li><p><strong>max_freq</strong> (<em>float, default=100</em>) – The maximum frequency to consider when computing IMCs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>EIMs</strong> (<em>list</em>) – A list of the endogenous intermodulation components (EIMs) for each peak.</p></li>
<li><p><strong>IMCs_all</strong> (<em>dict</em>) – A dictionary containing information about all the pairs of peaks and their associated IMCs
that satisfy the <cite>min_IMs</cite> threshold. The dictionary has the following keys:</p>
<ul>
<li><p><cite>IMs</cite>: a list of lists, where each list contains the IMCs associated with a pair of peaks.</p></li>
<li><p><cite>peaks</cite>: a list of lists, where each list contains the frequencies of the two peaks.</p></li>
<li><p><cite>n_IMs</cite>: a list of integers, where each integer represents the number of IMCs associated with a pair of peaks.</p></li>
<li><p><cite>amps</cite>: a list of lists, where each list contains the amplitudes of the two peaks.</p></li>
</ul>
</li>
<li><p><strong>n_IM_peaks</strong> (<em>int</em>) – The total number of pairs of peaks and their associated IMCs that satisfy the <cite>min_IMs</cite> threshold.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EIMs</span><span class="p">,</span> <span class="n">IMCs_all</span><span class="p">,</span> <span class="n">n_IM_peaks</span> <span class="o">=</span> <span class="n">endogenous_intermodulations</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">amps</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_IMs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IMCs_all</span>
<span class="go">{&#39;IMs&#39;: [[5, 21]], &#39;peaks&#39;: [[9, 13]], &#39;n_IMs&#39;: [2], &#39;amps&#39;: [[0.5, 0.4]]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.compute_sidebands">
<span class="sig-name descname"><span class="pre">compute_sidebands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">carrier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#compute_sidebands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.compute_sidebands" title="Link to this definition">#</a></dt>
<dd><p>Computes the frequency values of the sidebands resulting from the
interaction of a carrier signal and a modulating signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>carrier</strong> (<em>float</em>) – The frequency value of the carrier signal.</p></li>
<li><p><strong>modulator</strong> (<em>float</em>) – The frequency value of the modulating signal.</p></li>
<li><p><strong>order</strong> (<em>int, default=2</em>) – The order of the highest sideband to compute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>numpy.ndarray</em> – A sorted 1D array of frequency values for the sidebands.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_sidebands</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">array([700., 800., 900., 1100., 1200., 1300.])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compute_sidebands</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([350., 425., 575., 650.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.UnivariateTransformerMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UnivariateTransformerMixin</span></span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#UnivariateTransformerMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.UnivariateTransformerMixin" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mixin class for all univariate transformers in pyts.</p>
<dl class="py method">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.UnivariateTransformerMixin.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#UnivariateTransformerMixin.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.UnivariateTransformerMixin.fit_transform" title="Link to this definition">#</a></dt>
<dd><p>Fit to data, then transform it.</p>
<p>Fits transformer to <cite>X</cite> and <cite>y</cite> with optional parameters <cite>fit_params</cite>
and returns a transformed version of <cite>X</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like, shape = (n_samples, n_timestamps)</em>) – Univariate time series.</p></li>
<li><p><strong>y</strong> (<em>None or array-like, shape = (n_samples,) (default = None)</em>) – Target values (None for unsupervised transformations).</p></li>
<li><p><strong>**fit_params</strong> (<em>dict</em>) – Additional fit parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X_new</strong> (<em>array</em>) – Transformed array.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.SingularSpectrumAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SingularSpectrumAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_frequency_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.075</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_frequency_contribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#SingularSpectrumAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#biotuner.peaks_extraction.UnivariateTransformerMixin" title="biotuner.peaks_extraction.UnivariateTransformerMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTransformerMixin</span></code></a></p>
<p>Singular Spectrum Analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_size</strong> (<em>int or float (default = 4)</em>) – Size of the sliding window (i.e. the size of each word). If float, it
represents the percentage of the size of each time series and must be
between 0 and 1. The window size will be computed as
<code class="docutils literal notranslate"><span class="pre">max(2,</span> <span class="pre">ceil(window_size</span> <span class="pre">*</span> <span class="pre">n_timestamps))</span></code>.</p></li>
<li><p><strong>groups</strong> (<em>None, int, ‘auto’, or array-like (default = None)</em>) – The way the elementary matrices are grouped. If None, no grouping is
performed. If an integer, it represents the number of groups and the
bounds of the groups are computed as
<code class="docutils literal notranslate"><span class="pre">np.linspace(0,</span> <span class="pre">window_size,</span> <span class="pre">groups</span> <span class="pre">+</span> <span class="pre">1).astype('int64')</span></code>.
If ‘auto’, then three groups are determined, containing trend,
seasonal, and residual. If array-like, each element must be array-like
and contain the indices for each group.</p></li>
<li><p><strong>lower_frequency_bound</strong> (<em>float (default = 0.075)</em>) – The boundary of the periodogram to characterize trend, seasonal and
residual components. It must be between 0 and 0.5.
Ignored if <code class="docutils literal notranslate"><span class="pre">groups</span></code> is not set to ‘auto’.</p></li>
<li><p><strong>lower_frequency_contribution</strong> (<em>float (default = 0.85)</em>) – The relative threshold to characterize trend, seasonal and
residual components by considering the periodogram.
It must be between 0 and 1. Ignored if <code class="docutils literal notranslate"><span class="pre">groups</span></code> is not set to ‘auto’.</p></li>
<li><p><strong>chunksize</strong> (<em>int or None (default = None)</em>) – If int, the transformation of the whole dataset is performed using
chunks (batches) and <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> corresponds to the maximum size of
each chunk (batch). If None, the transformation is performed on the
whole dataset at once. Performing the transformation with chunks is
likely to be a bit slower but requires less memory.</p></li>
<li><p><strong>n_jobs</strong> (<em>None or int (default = None)</em>) – The number of jobs to use for the computation. Only used if
<code class="docutils literal notranslate"><span class="pre">chunksize</span></code> is set to an integer.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>N. Golyandina, and A. Zhigljavsky, “Singular Spectrum Analysis for
Time Series”. Springer-Verlag Berlin Heidelberg (2013).</p>
</aside>
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>T. Alexandrov, “A Method of Trend Extraction Using Singular
Spectrum Analysis”, REVSTAT (2008).</p>
</aside>
</aside>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_gunpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyts.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">SingularSpectrumAnalysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_gunpoint</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">SingularSpectrumAnalysis</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_new</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_new</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(50, 5, 150)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.SingularSpectrumAnalysis.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#SingularSpectrumAnalysis.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.fit" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="biotuner.peaks_extraction.SingularSpectrumAnalysis.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/biotuner/peaks_extraction.html#SingularSpectrumAnalysis.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.transform" title="Link to this definition">#</a></dt>
<dd><p>Transform the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like, shape = (n_samples, n_timestamps)</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X_new</strong> (<em>array-like, shape = (n_samples, n_splits, n_timestamps)</em>) – Transformed data. <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> value depends on the value of
<code class="docutils literal notranslate"><span class="pre">groups</span></code>. If <code class="docutils literal notranslate"><span class="pre">groups=None</span></code>, <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> is equal to
<code class="docutils literal notranslate"><span class="pre">window_size</span></code>. If <code class="docutils literal notranslate"><span class="pre">groups</span></code> is an integer, <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> is
equal to <code class="docutils literal notranslate"><span class="pre">groups</span></code>. If <code class="docutils literal notranslate"><span class="pre">groups='auto'</span></code>, <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> is equal
to three. If <code class="docutils literal notranslate"><span class="pre">groups</span></code> is array-like, <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> is equal to
the length of <code class="docutils literal notranslate"><span class="pre">groups</span></code>. If <code class="docutils literal notranslate"><span class="pre">n_splits=1</span></code>, <code class="docutils literal notranslate"><span class="pre">X_new</span></code> is squeezed
and its shape is (n_samples, n_timestamps).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="metrics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Harmonicity Metrics</p>
      </div>
    </a>
    <a class="right-next"
       href="peaks_extension.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Peaks Extension</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.EMD_eeg"><code class="docutils literal notranslate"><span class="pre">EMD_eeg()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SSA_EEG"><code class="docutils literal notranslate"><span class="pre">SSA_EEG()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.extract_welch_peaks"><code class="docutils literal notranslate"><span class="pre">extract_welch_peaks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.compute_FOOOF"><code class="docutils literal notranslate"><span class="pre">compute_FOOOF()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.HilbertHuang1D"><code class="docutils literal notranslate"><span class="pre">HilbertHuang1D()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.cepstrum"><code class="docutils literal notranslate"><span class="pre">cepstrum()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.cepstral_peaks"><code class="docutils literal notranslate"><span class="pre">cepstral_peaks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.pac_frequencies"><code class="docutils literal notranslate"><span class="pre">pac_frequencies()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.polycoherence"><code class="docutils literal notranslate"><span class="pre">polycoherence()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.polyspectrum_frequencies"><code class="docutils literal notranslate"><span class="pre">polyspectrum_frequencies()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.harmonic_recurrence"><code class="docutils literal notranslate"><span class="pre">harmonic_recurrence()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.endogenous_intermodulations"><code class="docutils literal notranslate"><span class="pre">endogenous_intermodulations()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.compute_sidebands"><code class="docutils literal notranslate"><span class="pre">compute_sidebands()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.UnivariateTransformerMixin"><code class="docutils literal notranslate"><span class="pre">UnivariateTransformerMixin</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.UnivariateTransformerMixin.fit_transform"><code class="docutils literal notranslate"><span class="pre">UnivariateTransformerMixin.fit_transform()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.fit"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biotuner.peaks_extraction.SingularSpectrumAnalysis.transform"><code class="docutils literal notranslate"><span class="pre">SingularSpectrumAnalysis.transform()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antoine Bellemare & François Lespinasse. This documentation and code are licensed under the <a href="https://opensource.org/licenses/MIT">MIT License</a>.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023–2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>